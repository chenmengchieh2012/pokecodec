@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

:root {
  --emerald-bg: #408880;        
  --emerald-dark: #204840;      
  --emerald-light: #78C8B8;     
  --card-bg: #F8F8F8;           
  --text-dark: #202020;         
  --ui-border: #303840;
  
  --hp-green: #58D080;
  --hp-yellow: #F8B050;
  --hp-red: #F85838;
}

.emeraldContainer {
  display: flex;
  flex-direction: row;
  height: 100vh;
  background-color: var(--emerald-bg);
  background-image: repeating-linear-gradient(
    45deg,
    var(--emerald-bg),
    var(--emerald-bg) 10px,
    #387870 10px,
    #387870 12px
  );
  font-family: 'Press Start 2P', monospace;
  color: var(--text-dark);
  font-size: 12px;
  overflow: hidden;
  image-rendering: pixelated;
  user-select: none;
}

/* --- Sidebar (精簡 Icon 版) --- */
.sideBar {
    width: 60px;
    background-color: var(--emerald-dark);
    border-right: 4px solid var(--ui-border);
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-top: 10px;
    flex-shrink: 0;
}

.tabs {
    display: flex;
    flex-direction: column;
    gap: 10px;
    width: 100%;
    align-items: center;
}

.iconTab {
    width: 40px;
    height: 40px;
    background-color: rgba(0,0,0,0.3);
    border-radius: 8px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    border: 2px solid transparent;
    transition: all 0.1s;
}

.iconTab:hover {
    background-color: rgba(255,255,255,0.1);
    border-color: var(--emerald-light);
}

.iconTab.active {
    background-color: var(--card-bg);
    border-color: var(--ui-border);
    box-shadow: 2px 2px 0 rgba(0,0,0,0.2);
}

.tabSvg {
    width: 24px;
    height: 24px;
    fill: #78C8B8;
}

.iconTab.active .tabSvg {
    fill: var(--text-dark);
}

.scrollArea {
  flex: 1;
  overflow-y: auto;
  padding: 12px; /* 留一點空間給展開動畫 */
  scrollbar-width: thin;
  scrollbar-color: var(--emerald-light) var(--emerald-dark);
}

/* --- 6x1 Grid 佈局 --- */
.partyGrid {
  display: grid;
  grid-template-columns: repeat(6, 1fr); /* 強制 6 欄 */
  gap: 4px;
  align-items: flex-end; /* 底部對齊 (讓球在同一水平線) */
  padding-bottom: 20px;
}

/* --- 單個欄位 (包含上方的預覽卡 + 下方的球) --- */
.ballSlot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-end;
  cursor: pointer;
  transition: transform 0.2s;
  position: relative;
}

.ballSlot:hover {
  transform: translateY(-4px); /* 懸停時整組稍微浮起 */
}

/* --- 常駐預覽卡 (原本的 Tooltip) --- */
/* 重點：要大，一直顯示 */
.previewCard {
  width: 100%;
  aspect-ratio: 1/1; /* 正方形 */
  background: #fff;
  border: 2px solid #202020;
  border-radius: 4px;
  margin-bottom: 4px; /* 與球的距離 */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  box-shadow: 2px 2px 0 rgba(0,0,0,0.2);
  position: relative;
  /* overflow: hidden; Removed to allow arrow to stick out */
}

/* 讓預覽卡底下有個小尖角指著球 (可選，增加連結感) */
.previewCard::after {
  content: '';
  position: absolute;
  bottom: -5px;
  left: 50%;
  transform: translateX(-50%) rotate(45deg);
  width: 6px;
  height: 6px;
  background: #fff;
  border-right: 2px solid #202020;
  border-bottom: 2px solid #202020;
}

/* 預覽卡內的圖示 */
.previewIcon {
  width: 95%;
  height: 95%;
  image-rendering: pixelated;
  object-fit: contain;
}

/* 預覽卡內的 HP 條 (迷你版) */
.miniHpBar {
  position: absolute;
  bottom: 2px;
  left: 2px;
  right: 2px;
  height: 3px;
  background: #555;
  border-radius: 1px;
}
.miniHpFill { height: 100%; }

/* --- 下方的球 (要小) --- */
.ballBase {
  width: 28px; /* 小球 */
  height: 28px;
  object-fit: contain;
  filter: drop-shadow(0 2px 2px rgba(0,0,0,0.4));
  z-index: 2;
}

/* --- Modal Overlay --- */
.modalOverlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  backdrop-filter: blur(2px);
}

/* --- Summary Card (Popup) - HPBlock Style --- */
.summaryCard {
  position: relative; /* Fix: Ensure absolute children are positioned relative to this card */
  width: 340px;
  background-color: #f8f8f0; /* Warmer white */
  border: 3px solid #303030;
  border-radius: 12px;
  border-bottom-right-radius: 30px; /* Distinctive shape */
  box-shadow: 6px 6px 0px rgba(0,0,0,0.25);
  padding: 16px;
  display: flex;
  flex-direction: row;
  gap: 16px;
  animation: popupAnim 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  font-family: 'VT323', monospace; /* Try to match font if possible, or fallback */
  color: #202020;
}

@keyframes popupAnim {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

/* --- Left: Photo Frame & Info --- */
.cardLeft {
  width: 120px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  align-items: center;
}

.imageContainer {
  width: 100%;
  aspect-ratio: 1/1; /* 保持正方形 */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: #fff;
  border: 2px solid #303030;
  border-radius: 8px;
  position: relative;
  box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
}

.mainIcon { width: 80%; height: 80%; image-rendering: pixelated; object-fit: contain; }

.infoBlock {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  width: 100%;
}

.nameRow {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  flex-wrap: wrap;
  text-align: center;
}

.nameBallIcon {
  width: 16px;
  height: 16px;
  object-fit: contain;
}

.pkmName { 
  font-size: 14px; 
  font-weight: 900; 
  color: #202020; 
  text-transform: uppercase;
  letter-spacing: 1px;
}

.pkmLv { 
  font-size: 14px; 
  font-weight: bold; 
  color: #555; 
}

/* --- Right: Info --- */
.cardRight {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-width: 0;
}

.controlsRow {
  display: flex;
  justify-content: flex-end;
  margin-bottom: 4px;
}

.miniControls {
  display: flex;
  gap: 6px;
}

.iconBtn {
  background: #fff;
  border: 1px solid #ccc;
  border-radius: 4px;
  cursor: pointer;
  padding: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #666;
  transition: all 0.1s;
  box-shadow: 1px 1px 0 rgba(0,0,0,0.1);
}

.iconBtn:hover {
  background: #f0f0f0;
  color: #202020;
  border-color: #888;
  transform: translateY(-1px);
}

.iconBtn:active {
  transform: translateY(0);
  box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
}

/* HP Bar - HPBlock Style */
.hpRow { 
  display: flex; 
  align-items: center; 
  gap: 8px; 
  background: #e8e8e0;
  padding: 4px 8px;
  border-radius: 12px;
}
.hpText { 
  font-size: 12px; 
  font-weight: bold; 
  color: #202020; 
  min-width: auto;
}
.hpBar { 
  flex: 1; 
  height: 10px; 
  background: #303030; 
  border: none; 
  border-radius: 5px; 
  padding: 2px;
  position: relative; 
}
.hpFill { 
  height: 100%; 
  border-radius: 3px;
  transition: width 0.3s; 
  box-shadow: inset 0 2px 0 rgba(255,255,255,0.3), inset 0 -2px 0 rgba(0,0,0,0.1);
}

/* Stats - Clean Style */
.statsBox {
  display: grid; 
  grid-template-columns: 1fr 1fr 1fr; 
  gap: 6px;
  background: transparent; 
  padding: 0; 
  border-radius: 0;
}
.statItem { 
  font-size: 12px; 
  display: flex; 
  flex-direction: column;
  align-items: center;
  background: #fff;
  border: 1px solid #ccc;
  border-radius: 4px;
  padding: 4px;
  color: #202020; 
}
.statLabel { 
  color: #888; 
  font-size: 10px; 
  font-weight: bold; 
  margin-bottom: 2px;
}

/* Moves - Clean Style */
.movesGrid { 
  display: grid; 
  grid-template-columns: 1fr 1fr; 
  gap: 6px; 
  margin-top: 4px; 
}
.moveItem { 
  background: #303030; 
  border: none;
  border-radius: 4px;
  font-size: 10px; 
  padding: 6px; 
  text-align: center; 
  color: #fff; 
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Actions */
.actionRow { margin-top: auto; display: flex; gap: 10px; }
.miniBtn {
  flex: 1; 
  border: 2px solid #303030; 
  font-family: inherit; 
  font-size: 12px;
  font-weight: bold;
  cursor: pointer; 
  padding: 8px; 
  color: #202020; 
  text-align: center; 
  border-radius: 6px;
  background: #fff;
  box-shadow: 2px 2px 0 #303030;
  transition: all 0.1s;
}
.btnClose { background: #e0e0e0; }
.btnSend { background: #ff8080; } /* Softer red */
.miniBtn:active { transform: translateY(2px); box-shadow: none; }

/* 空格子 (虛線框) */
.emptySlot {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-end;
    opacity: 0.3;
}
.emptyPreview {
    width: 100%;
    aspect-ratio: 1/1;
    border: 2px dashed #202020;
    border-radius: 4px;
    margin-bottom: 4px;
}
.emptyBall {
    width: 16px; height: 16px; background: #202020; border-radius: 50%;
}/* ... 前面 CSS 不變 ... */

/* --- Bag (背包系統) --- */
.bagContainer {
  display: flex;
  flex-direction: column;
  height: 100%;
  position: relative; /* 讓底部資訊條可以絕對定位 */
  overflow: hidden;   /* 防止資訊條跑出邊界 */
}

/* 口袋分類導航 (稍微縮小高度以節省空間) */
.pocketNav {
  display: flex;
  gap: 2px;
  border-bottom: 2px solid #303840;
  background: var(--emerald-bg);
  z-index: 5;
  flex-shrink: 0; /* 防止被壓縮 */
}

.pocketTab {
  flex: 1;
  background: rgba(0,0,0,0.2);
  padding: 6px 0; /* 縮小 Padding */
  text-align: center;
  color: #cbece6;
  font-size: 9px; /* 字體縮小 */
  cursor: pointer;
  transition: all 0.2s;
  font-weight: bold;
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
}

.pocketTab:hover {
  background: rgba(255,255,255,0.1);
  color: #fff;
}

.pocketTab.active {
  background: #303840; 
  color: #fff;
}

/* 道具網格區域 */
.bagGrid {
  flex: 1; /* 佔滿剩餘空間 */
  overflow-y: auto; /* 只有這區塊捲動 */
  
  display: grid;
  /* 縮小最小寬度至 48px，讓一排能塞更多 */
  grid-template-columns: repeat(auto-fill, minmax(48px, 1fr)); 
  gap: 6px;
  padding: 8px;
  
  /* 關鍵：底部留白，讓最後一排不會被 Footer 擋住 */
  padding-bottom: 60px; 
}

/* 單個道具格子 (稍微縮小) */
.bagSlot {
  background: #f0f0f0;
  border: 2px solid #5da696;
  border-radius: 4px; /* 圓角改小，更俐落 */
  aspect-ratio: 1/1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: relative;
  cursor: pointer;
  box-shadow: inset 0 0 5px rgba(0,0,0,0.05);
  transition: all 0.1s;
}

.bagSlot:hover {
  background: #fff;
  border-color: #204840;
  box-shadow: 0 0 0 1px #fff, 0 0 0 3px #204840; /* 顯眼的選中框 */
  z-index: 1;
  transform: translateY(-1px);
}

.bagItemIcon {
  width: 48px; /* 圖片縮小以適應格子 */
  height: 48px;
  image-rendering: pixelated;
  object-fit: contain;
}

.bagItemCount {
  position: absolute;
  bottom: 1px;
  right: 2px;
  font-size: 9px;
  font-weight: 900;
  color: #204840;
  text-shadow: 1px 1px 0 #fff; /* 改用陰影描邊，比背景塊更省空間 */
  pointer-events: none;
}